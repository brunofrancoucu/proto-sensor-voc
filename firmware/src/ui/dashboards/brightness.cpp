#include "ui/dashboards.h"
// Dual config page
#include "core/state.h" 
#include "ui/molecules.h"

static const unsigned char PROGMEM image_display_brightness_bits[] = {0x00,0x03,0x00,0x00,0x00,0x03,0x00,0x00,0x0c,0x03,0x00,0xc0,0x0c,0x03,0x00,0xc0,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x00,0x0f,0xc0,0x00,0x00,0x0f,0xc0,0x00,0xc0,0xf0,0x3c,0x0c,0xc0,0xf0,0x3c,0x0c,0x30,0xc0,0x0c,0x30,0x30,0xc0,0x0c,0x30,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x30,0xc0,0x0c,0x30,0x30,0xc0,0x0c,0x30,0xc0,0xf0,0x3c,0x0c,0xc0,0xf0,0x3c,0x0c,0x00,0x0f,0xc0,0x00,0x00,0x0f,0xc0,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x0c,0x03,0x00,0xc0,0x0c,0x03,0x00,0xc0,0x00,0x03,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

BrightnessView brightnessView;

void BrightnessView::paint() {
    static int brgthLast = -1; // value 0x
    static int brgthNormal = -1; // map() normalized
    
    // brightness (TODO: memo helper)
    if (brgthLast != state.display.brightness) {
        brgthLast = state.display.brightness;
        brgthNormal = map(state.display.brightness, 0, 255, 0, 100);
    }
    
    paintSetting(image_display_brightness_bits, String(brgthNormal) + " %");
}

void BrightnessView::onInput(Button& button) {
    static int prev = state.display.brightness;
    if (button.pin == state.input.pins.LFT) {
        // LFT();
        state.display.setBrightness(prev - 6);
    } else if (button.pin == state.input.pins.MID) {
        // MID();
        state.display.navTo(&menuView);
    } else if (button.pin == state.input.pins.RGT) {
        // RGT();
        state.display.setBrightness(prev + 6);
    }
}